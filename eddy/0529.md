## 테스트 작성의 비용

테스트의 장점에 대해선 누구나 동의할 것이다. 테스트가 중요하다는 것은 누구나 공감한다. 마치 건강을 위해 금연 금주 하세요~ 같이 당연한 말처럼 들린다.

하지만 막상 테스트를 하다보면, 테스트 이걸 정말 해야하나? 라는 생각이 든다.

왜냐, 제대로 된 테스트를 작성하려면 비용이 들기 때문이다. 테스트를 제대로 작성하지 않으면 안하느니만 못하다.

## 단위 테스트를 제대로 한다는 게 뭔데?

단위 테스트는 몇 가지 원칙을 지켜야 한다.
테스트의 목적은 우리가 믿고 변경을 할 수 있도록 만드는 것이고, 
목적에 부합해야 좋은 테스트다.

FIRST라는 원칙이 있다. FAST. INDEPENDENT. REPEATABLE. SELF-VALIDATING. TIMELY

좀 더 내말로 풀어서 설명해보자면, 테스트는 어떤상황에서, 누가 실행하더라도 100% 신뢰할 수 있어야 한다. 동시에 인과관계를 명확하게 알려줘야 한다. 어떤 유닛이 테스트를 실패한 것인지. 기대값과 실제값은 무엇이었는지. 실패하지 않았는데 실패했다고 하는 경우도 없어야 하며, 성공하지 않았는데 성공했다고 하는 경우도 없어야 한다.

테스트가 틀렸거나 맞았다면 그걸 테스트가 명확하게 Pass/Fail로 알려줘야 한다.내가 결과를 보고 제대로 됐는지 판단하면 안 된다. 예를 들면 프린트만 하고 그걸 사람이 직접 확인해야 테스트의 통과 여부를 판단할 수 있다면 좋은 테스트가 아니다. 사람이 판단하면, 주관적이 된다. 많은 추가적인 노력이들어가게 되고 그때 그때 결과도 달라질 것이다. 결과적으로 테스트를 믿을 수 없게 된다.

테스트는 와이파이가 없어도 실행할 수 없어야 한다. 테스트가 돌아가지 않는 환경이 있다면, 테스트가 실패한 이유를 둘러댈 변명이 생긴다.
결국 테스트의 원칙이 강조하는 것은 무엇이냐면, 테스트가 테스트하는 입출력이 잘못되었으면 잘못되었다고 뜨고, 잘못되지 않았으면 잘못되지 않았다고 떠야 한다. 다른 곳에서 영향을 받아서, 테스트가 실패할 때도 있고, 안 실패할 때도 있다면. 테스트는 일관적이어야 하고 그걸 우리는 믿을 수 있어야 한다.

테스트는 서로 의존해서는 안 된다. 각각 따로 실행하고 순서를 바꿔도 결과가 같아야 한다. 만약 특정한 테스트가 실패했을 때, 다른 테스트에 대한 의존 때문에 실패한 것이라면, 우리는 정확히 어떤 부분이 원인을 제공했는지 찾기 어려워지고, 혹시나 실패해야하는 테스트인데 의존성에 영향을 받아서 진짜 버그가 숨겨질 수있다.

테스트는 빨라야한다. 테스트가 느리면 자주 돌릴 엄두를 내지 못한다. 자주 테스트를 하지 않으면 문제를 빨리 고치지 못한다. 코드를 쉽게 변경할수가 없다.

단위 테스트도 읽는 사람을 고려해서 가독성 좋게 써야한다.
테스트의 가독성은 매우 중요하다.  클린 코드에 나오는 예시 설명.
테스트 코드도 유지보수가 필요하기 때문이다. 테스트 코드도 클린하게 짜야지 그 효과를 제대로 볼 수 있다.

단위 테스트 프레임워크를 쓰고, 테스트 코드의 원칙은 이미 잘 알려진 베스트 프랙티스를 따르면 어느 정도 해결된다.

하지만 그래도 어려운 점이 하나 있다.

