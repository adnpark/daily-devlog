# 업그레이더블 컨트랙트의 모든것

Created: May 8, 2022 1:26 AM

Part 1 - 업그레이더블 컨트랙트란?

Part 2 - Proxy Contract 딥다이브

Part 3 - Beacon Proxy Contract 딥다이브

Part 4 - Minimal Proxy Contract 딥다이브

Part 5 - Minimal Beacon Proxy Contract 딥다이브

흔히 블록체인에 있는 스마트 컨트랙트의 코드는 절대로 변경할 수 없다는 이야기를 많이 들어왔을것이다. (그것이 “컨트랙트” 즉, 코드로 구현된 계약의 핵심 장점이기도 하다.) 실제로 그 말은 맞다. 하지만, 언제나 그렇듯 개발자들은 이를 우회하여 원하는 바를 얻고자 하는 사람들이다. 사실, 이제는 컨트랙트 개발자들에게 이런 것들은 너무 뻔한 내용일지 모르겠지만, 컨트랙트 개발을 하면서 한번쯤은 지나칠 수 밖에 없는 주제이기 때문에 이번에 깊게 다뤄보고자 한다. 

바로 업그레이드 가능한 컨트랙트, 즉 업그레이더블 컨트랙트(Upgredable Contract)가 이번 시리즈 글의 주제다. 업그레이더블 컨트랙트는 말 그대로 기능에 대한 업그레이드가 가능한 컨트랙트를 의미한다. 그런데 스마트 컨트랙트의 코드는 절대로 변경할 수 없는데, 어떻게 업그레이드를 한다는 것일까? 그 비밀은 바로 프록시 패턴(Proxy Pattern)에 숨겨져 있다. 흔히 컴퓨터 프로그래밍에서 프록시 패턴이라고 한다면, 무언가를 대신해서 이어주는 역할을 해주는 구조를 의미한다. 일상적으로 접하는 예시인 “프록시 서버”의 경우 진짜 서버는 따로 있고, 이 서버와 대신해서 중간에 연결해주는 역할을 프록시 서버가 수행하게 된다.

우리가 앞으로 쭉 개발하게 될 스마트 컨트랙트도 이러한 프록시 패턴을 활용하여 업그레이더블 컨트랙트를 구현할 수 있다. 생각을 해보면 매우 단순하다. 만약 컨트랙트의 코드 실행을 프록시 컨트랙트를 통해 상황에 따라 다른 컨트랙트의 코드를 사용하게 할 수 있다면? 프록시 컨트랙트에 어떤 컨트랙트의 코드를 실행할지만 그 때 그 때 명시한다면 손쉽게 업그레이더블 컨트랙트를 구현할 수 있다. 물론, 지금과 같이 말로만 설명하면 이해가 안되니 간단하게 도식화를 해서 살펴보자.

그런데 이런 구조가 도대체 어떻게 가능한것인가? 컨트랙트의 코드 실행은 컨트랙트 내부에 구현된 함수를 통해서만 되는것이 아닌가? 하는 의문이 생길 수 있다. 사실 이러한 프록시 패턴은 바로 DelegateCall의 존재 때문에 가능하다. 

그렇다면 DelegateCall은 무엇인가? 이를 이해하려면 이더리움의 어카운트 구조를 이해해야 한다.

- DelegateCall 설명
- 이더리움 어카운트 구조 간단하게 설명
- 프록시 패턴에 대한 전반적인 변천사?
    - 프록시 컨트랙트, 비콘 프록시 컨트랙트, 미니멀 프록시 컨트랙트, 미니멀 비콘 프록시 컨트랙트